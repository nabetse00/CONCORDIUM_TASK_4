import{j as a}from"./index-486d3cb4.js";import{r as u,b as l}from"./wallet-05f4693c.js";import{g as b}from"./invokeContractFn-022ec71d.js";import{v as g,T as C}from"./ui-276e3024.js";import{e as j,f as E,g as D,h as k}from"./icons-b790460c.js";const{Panel:w}=g;function P(i){const[m,c]=u.useState(!0),[T,S]=u.useState(!1),[n,d]=u.useState([{label:new Date(Date.now()).toLocaleString(),children:`Transaction [${i.hash}] sent`,color:"red"}]),x=i.timeoutMilisec?i.timeoutMilisec:500;function f(t){if(t){if(n.length>0&&n[n.length-1].children!==t.children){d(s=>[...s,t]);return}if(n.length==0){d(s=>[...s,t]);return}if(n.length>0&&n[n.length-1].children===t.children){d([...n]);return}}}function h(t){if(t){const s=new Date(Date.now()).toLocaleString();let e,o,r;switch(t.status.toString()){case l.TransactionStatusEnum.Committed:e="Transaction committed",o=a.jsx(k,{}),r="grey";break;case l.TransactionStatusEnum.Received:e="Transaction recieved",r="blue",o=a.jsx(D,{});break;case l.TransactionStatusEnum.Finalized:console.log("from txn Status finish"),e="Transaction Finalized",r="green",o=a.jsx(E,{});break;default:console.log("from txn Status ????"),e="Transaction is `unknown` possible error",r="red",o=a.jsx(j,{});break}return{label:s,children:e,dot:o,color:r}}}return u.useEffect(()=>{let t,s;return T||b(i.connection,i.hash).then(e=>{s=e,e&&e.status===l.TransactionStatusEnum.Finalized&&(f(h(s)),c(!1),S(!0),i.callback()),c(!1),e&&e.status!==l.TransactionStatusEnum.Finalized&&c(!0)}).catch(e=>{console.error(e),c(!1)}),m&&(t=setTimeout(()=>f(h(s)),x)),()=>{clearTimeout(t)}},[i,n,m]),a.jsx(g,{defaultActiveKey:["1"],children:a.jsx(w,{header:"Transaction status",children:a.jsx(C,{mode:"left",items:n,pending:m})},1)})}export{P as T};

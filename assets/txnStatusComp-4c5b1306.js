import{j as s}from"./index-7a162a28.js";import{r as l,b as d}from"./wallet-05f4693c.js";import{B as S,w as j,x,y as w}from"./ui-39a4cd14.js";import{b as M}from"./invokeContractFn-42342478.js";import{e as b,f as k,g as E,h as O}from"./icons-dea615b7.js";function P(e){const[c,i]=l.useState(!1),m=()=>{i(!0)},f=()=>{e.confirm(),i(!1)},n=()=>{e.cancel(),i(!1)};return l.useEffect(()=>{e.showConfirmModal?i(!0):i(!1)},[e.showConfirmModal]),s.jsxs(s.Fragment,{children:[e.showButton&&s.jsx(S,{type:"primary",onClick:m,children:"Open Modal"}),s.jsx(j,{title:e.title,okText:"Confirm",cancelText:"Cancel",open:c,onOk:f,onCancel:n,children:e.content})]})}const{Panel:D}=x;function L(e){const[c,i]=l.useState(!0),[m,f]=l.useState(!1),[n,h]=l.useState([{label:new Date(Date.now()).toLocaleString(),children:`Transaction [${e.hash}] sent`,color:"red"}]),C=e.timeoutMilisec?e.timeoutMilisec:500;function T(a){if(a){if(n.length>0&&n[n.length-1].children!==a.children){h(o=>[...o,a]);return}if(n.length==0){h(o=>[...o,a]);return}if(n.length>0&&n[n.length-1].children===a.children){h([...n]);return}}}function g(a){if(a){const o=new Date(Date.now()).toLocaleString();let t,r,u;switch(a.status.toString()){case d.TransactionStatusEnum.Committed:t="Transaction committed",r=s.jsx(O,{}),u="grey";break;case d.TransactionStatusEnum.Received:t="Transaction recieved",u="blue",r=s.jsx(E,{});break;case d.TransactionStatusEnum.Finalized:console.log("from txn Status finish"),t="Transaction Finalized",u="green",r=s.jsx(k,{});break;default:console.log("from txn Status ????"),t="Transaction is `unknown` possible error",u="red",r=s.jsx(b,{});break}return{label:o,children:t,dot:r,color:u}}}return l.useEffect(()=>{let a,o;return m||M(e.connection,e.hash).then(t=>{o=t,t&&t.status===d.TransactionStatusEnum.Finalized&&(T(g(o)),i(!1),f(!0),e.callback()),i(!1),t&&t.status!==d.TransactionStatusEnum.Finalized&&i(!0)}).catch(t=>{console.error(t),i(!1)}),c&&(a=setTimeout(()=>T(g(o)),C)),()=>{clearTimeout(a)}},[e,n,c]),s.jsx(x,{defaultActiveKey:["1"],children:s.jsx(D,{header:"Transaction status",children:s.jsx(w,{mode:"left",items:n,pending:c})},1)})}export{P as M,L as T};
